---

title: SupCon ImageWang Tutorial


keywords: fastai
sidebar: home_sidebar



nb_path: "examples/vision/07 - training_supcon_iwang.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: examples/vision/07 - training_supcon_iwang.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note:</strong> This notebook demonstrates how to use <a href="/self_supervised/16 - supcon.html#SupCon"><code>SupCon</code></a> callback with a single GPU. For distributed version, <code>DistributedSupCon</code> checkout documentation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First import <strong>fastai</strong> for training and other helpers, you can choose not to use <strong>wandb</strong> by setting <code>WANDB=False</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">WANDB</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">WANDB</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">fastai.callback.wandb</span> <span class="kn">import</span> <span class="n">WandbCallback</span>
        <span class="kn">import</span> <span class="nn">wandb</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;Please run &#39;!pip install wandb&#39; on another cell to install wandb&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then import <strong>self_supervised</strong> <code>augmentations</code> module for creating augmentations pipeline, <code>layers</code> module for creating encoder and model, and finally <code>simclr</code> for self-supervised training.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">self_supervised.augmentations</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">self_supervised.layers</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">self_supervised.vision.supcon</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">self_supervised.vision.metrics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">timm</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this notebook we will take a look at <a href="https://github.com/fastai/imagenette#image%E7%BD%91">ImageWang</a> benchmark, how to train a self-supervised model using MoCo algorithm and then how to use this pretrained model for finetuning on the given downstream task.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pretraining">Pretraining<a class="anchor-link" href="#Pretraining"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_dls</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">n_per_class</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">IMAGEWANG_160</span> <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">160</span> <span class="k">else</span> <span class="n">URLs</span><span class="o">.</span><span class="n">IMAGEWANG</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;unsup&#39;</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">])</span>

    
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">files</span><span class="p">)]</span>
    <span class="n">split_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">valid_idxs</span> <span class="o">=</span> <span class="n">split_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;label != &#39;unsup&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n_per_class</span><span class="p">)[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">split_df</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">split_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">split_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">valid_idxs</span><span class="p">),</span> <span class="s1">&#39;is_valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">train_idxs</span> <span class="o">=</span> <span class="n">split_df</span><span class="p">[</span><span class="o">~</span><span class="n">split_df</span><span class="o">.</span><span class="n">is_valid</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">valid_idxs</span> <span class="o">=</span> <span class="n">split_df</span><span class="p">[</span><span class="n">split_df</span><span class="o">.</span><span class="n">is_valid</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    
    <span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PILImage</span><span class="o">.</span><span class="n">create</span><span class="p">,</span> <span class="n">ToTensor</span><span class="p">,</span> <span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">min_scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">)],</span> 
            <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]]</span>
    <span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="p">[</span><span class="n">train_idxs</span><span class="p">,</span> <span class="n">valid_idxs</span><span class="p">])</span>
    <span class="n">batch_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">IntToFloatTensor</span><span class="p">]</span>
    <span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dls</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ImageWang has several benchmarks for different image sizes, in this tutorial we will go for <code>size=224</code> and also demonstrate how effectively you can utilize GPU memory.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define batch size, resize resolution before batching and size for random cropping during self-supervised training. It's always good to use a batch size as high as it can fit the GPU memory.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">224</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">IMAGEWANG_160</span> <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">160</span> <span class="k">else</span> <span class="n">URLs</span><span class="o">.</span><span class="n">IMAGEWANG</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Counter</span><span class="p">([(</span><span class="n">o</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">files</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Counter({(&#39;imagewang&#39;, &#39;unsup&#39;): 7750,
         (&#39;val&#39;, &#39;n02089973&#39;): 224,
         (&#39;val&#39;, &#39;n02096294&#39;): 407,
         (&#39;val&#39;, &#39;n02086240&#39;): 409,
         (&#39;val&#39;, &#39;n02105641&#39;): 422,
         (&#39;val&#39;, &#39;n02099601&#39;): 401,
         (&#39;val&#39;, &#39;n02087394&#39;): 408,
         (&#39;val&#39;, &#39;n02088364&#39;): 418,
         (&#39;val&#39;, &#39;n02093754&#39;): 401,
         (&#39;val&#39;, &#39;n02115641&#39;): 410,
         (&#39;val&#39;, &#39;n02111889&#39;): 429,
         (&#39;train&#39;, &#39;n02089973&#39;): 75,
         (&#39;train&#39;, &#39;n02096294&#39;): 147,
         (&#39;train&#39;, &#39;n02086240&#39;): 142,
         (&#39;train&#39;, &#39;n03000684&#39;): 1244,
         (&#39;train&#39;, &#39;n01440764&#39;): 1350,
         (&#39;train&#39;, &#39;n02979186&#39;): 1350,
         (&#39;train&#39;, &#39;n02102040&#39;): 1350,
         (&#39;train&#39;, &#39;n02105641&#39;): 126,
         (&#39;train&#39;, &#39;n03394916&#39;): 1350,
         (&#39;train&#39;, &#39;n03445777&#39;): 1350,
         (&#39;train&#39;, &#39;n03417042&#39;): 1350,
         (&#39;train&#39;, &#39;n03425413&#39;): 1350,
         (&#39;train&#39;, &#39;n02099601&#39;): 127,
         (&#39;train&#39;, &#39;n03028079&#39;): 1350,
         (&#39;train&#39;, &#39;n02087394&#39;): 119,
         (&#39;train&#39;, &#39;n02088364&#39;): 141,
         (&#39;train&#39;, &#39;n02093754&#39;): 146,
         (&#39;train&#39;, &#39;n03888257&#39;): 1350,
         (&#39;train&#39;, &#39;n02115641&#39;): 114,
         (&#39;train&#39;, &#39;n02111889&#39;): 138})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Select architecture to train on, remember all <strong>timm</strong> and <strong>fastai</strong> models are available! We need to set <code>pretrained=False</code> here because using imagenet weights for ImageWang data would be cheating.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">arch</span> <span class="o">=</span> <span class="s2">&quot;resnet50d&quot;</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">create_encoder</span><span class="p">(</span><span class="n">arch</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># arch = &quot;resnet34d&quot;</span>
<span class="c1"># encoder = CheckpointResNet(create_encoder(arch, pretrained=False, n_in=3), checkpoint_nchunks=2)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">WANDB</span><span class="p">:</span>
    <span class="n">xtra_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Arch&quot;</span><span class="p">:</span><span class="n">arch</span><span class="p">,</span> <span class="s2">&quot;Resize&quot;</span><span class="p">:</span><span class="n">resize</span><span class="p">,</span> <span class="s2">&quot;Size&quot;</span><span class="p">:</span><span class="n">size</span><span class="p">,</span> <span class="s2">&quot;Algorithm&quot;</span><span class="p">:</span><span class="s2">&quot;SupCon&quot;</span><span class="p">}</span>
    <span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s2">&quot;self-supervised-imagewang&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">xtra_config</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialize the Dataloaders using the function above.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">get_dls</span><span class="p">(</span><span class="n">resize</span><span class="p">,</span> <span class="n">bs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create SupCon model. You can change values of <code>hidden_size</code>, <code>projection_size</code>, and <code>n_layers</code>. For this problem, defaults work just fine so we don't do any changes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">create_supcon_model</span><span class="p">(</span><span class="n">encoder</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next step is perhaps the most critical step for achieving good results on a custom problem - data augmentation. For this, we will use utility function from <code>self_supervised.vision.supcon.get_simclr_aug_pipelines</code> but you can also use your own list of Pipeline augmentations. <code>self_supervised.vision.supcon.get_moco_aug_pipelines</code>should be enough for most of the cases since under the hood it uses <code>self_supervised.augmentations.get_multi_aug_pipelines</code> and <code>self_supervised.augmentations.get_batch_augs</code>. You can do shift+tab and see all the arguments that can be passed to <a href="/self_supervised/16 - supcon.html#get_supcon_aug_pipelines"><code>get_supcon_aug_pipelines</code></a>. You can simply pass anything that you could pass to <a href="/self_supervised/01 - augmentations.html#get_batch_augs"><code>get_batch_augs</code></a> including custom <code>xtra_tfms</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/self_supervised/16 - supcon.html#get_supcon_aug_pipelines"><code>get_supcon_aug_pipelines</code></a> excepts size for random resized cropping of the 2 views of a given image and the rest of the arguments are coming from <code>get_batch_augs()</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aug_pipelines</span> <span class="o">=</span> <span class="n">get_supcon_aug_pipelines</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rotate_deg</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we will feed the augmentation pipelines and leave temperature parameter as default.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SupCon</span><span class="p">(</span><span class="n">aug_pipelines</span><span class="p">,</span> 
            <span class="n">unsup_class_id</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unsup&#39;</span><span class="p">],</span> 
            <span class="n">unsup_method</span> <span class="o">=</span> <span class="n">UnsupMethod</span><span class="o">.</span><span class="n">All</span><span class="p">,</span> 
            <span class="n">reg_lambda</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> 
            <span class="n">temp</span> <span class="o">=</span> <span class="mf">0.07</span><span class="p">)]</span>

<span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SupConMOCO</span><span class="p">(</span><span class="n">aug_pipelines</span><span class="p">,</span> 
                <span class="n">unsup_class_id</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unsup&#39;</span><span class="p">],</span> 
                <span class="n">unsup_method</span> <span class="o">=</span> <span class="n">UnsupMethod</span><span class="o">.</span><span class="n">All</span><span class="p">,</span> 
                <span class="n">K</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
                <span class="n">m</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span>
                <span class="n">reg_lambda</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> 
                <span class="n">temp</span> <span class="o">=</span> <span class="mf">0.07</span><span class="p">)]</span>

<span class="k">if</span> <span class="n">WANDB</span><span class="p">:</span> <span class="n">cbs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">WandbCallback</span><span class="p">(</span><span class="n">log_preds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_model</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn_metric_cb</span> <span class="o">=</span> <span class="n">KNNProxyMetric</span><span class="p">()</span>
<span class="n">cbs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">knn_metric_cb</span><span class="p">]</span>
<span class="n">metric</span> <span class="o">=</span> <span class="n">ValueMetric</span><span class="p">(</span><span class="n">knn_metric_cb</span><span class="o">.</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="s1">&#39;knn_accuracy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">Lamb</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">cbs</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before starting training let's check whether our augmentations makes sense or not. Since this step consumes GPU memory, once you are done with inspection, restart the notebook and skip this step. We can see that 2 views of the same image side by side and indeed augmentations look pretty good. Now, it's time restart the notebook and skip this step.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">_split</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">learn</span><span class="p">(</span><span class="s1">&#39;before_batch&#39;</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">sup_con</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use mixed precision with <code>to_fp16()</code> for more GPU memory, larger batch size and faster training . We could also use gradient checkpointing wrapper models from <code>self_supervised.layers</code> to save even more memory, e.g. <code>CheckpointSequential()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Learning good representations via contrastive learning usually takes a lot of epochs. So here number epochs are set to 100. This might change depending on your data distribution and dataset size.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">,</span><span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_flat_cos</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="n">wd</span><span class="p">,</span> <span class="n">pct_start</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">WANDB</span><span class="p">:</span> <span class="n">wandb</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: right }
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>epoch</td><td>▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███</td></tr><tr><td>eps_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>knn_accuracy</td><td>▁▂▁▃▃▄▃▁▅▄▅▆▅▇▇▇▆▆▆▆▅█▅▇█▆▇▇</td></tr><tr><td>lr_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>mom_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>raw_loss</td><td>█▇▅▆▆▅▅▄▄▄▃▃▄▄▄▄▄▃▂▃▃▃▃▂▂▂▃▂▂▆▂▂▂▁▂▂▁▁▄▂</td></tr><tr><td>sqr_mom_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train_loss</td><td>█▇▆▆▅▅▅▄▄▄▄▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁</td></tr><tr><td>valid_loss</td><td>██▆▅▆▅▃▅▅▄▄▃▆▄▃▂▂▁▄▂▆▄▂▁▅▁▂▁</td></tr><tr><td>wd_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>epoch</td><td>28.25</td></tr><tr><td>eps_0</td><td>1e-05</td></tr><tr><td>knn_accuracy</td><td>0.18167</td></tr><tr><td>lr_0</td><td>0.001</td></tr><tr><td>mom_0</td><td>0.9</td></tr><tr><td>raw_loss</td><td>7.75702</td></tr><tr><td>sqr_mom_0</td><td>0.99</td></tr><tr><td>train_loss</td><td>7.72455</td></tr><tr><td>valid_loss</td><td>8.91475</td></tr><tr><td>wd_0</td><td>0.0001</td></tr></table><br/></div></div></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">Synced <strong style="color:#cdcd00">likely-jazz-70</strong>: <a href="https://wandb.ai/keremturgutlu/self-supervised-imagewang/runs/2j8iph1f" target="_blank">https://wandb.ai/keremturgutlu/self-supervised-imagewang/runs/2j8iph1f</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">Find logs at: <code>./wandb/run-20220308_023935-2j8iph1f/logs</code></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">save_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;supcon_iwang_sz</span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s1">_epc</span><span class="si">{</span><span class="n">epochs</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">learn</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_name</span><span class="p">)</span>
<span class="c1"># torch.save(learn.model.encoder.state_dict(), learn.path/learn.model_dir/f&#39;{save_name}_encoder.pth&#39;)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">resnet_model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">learn</span><span class="o">.</span><span class="n">path</span><span class="o">/</span><span class="n">learn</span><span class="o">.</span><span class="n">model_dir</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">save_name</span><span class="si">}</span><span class="s1">_encoder.pth&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wandb</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">name</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;bumbling-paper-72&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Downstream-Task">Downstream Task<a class="anchor-link" href="#Downstream-Task"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sqr_mom</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span><span class="n">mom</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">opt_func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">ranger</span><span class="p">,</span> <span class="o">**</span><span class="n">optdict</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">256</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_dls</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">bs</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">IMAGEWANG_160</span> <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">160</span> <span class="k">else</span> <span class="n">URLs</span><span class="o">.</span><span class="n">IMAGEWANG</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">])</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">(</span><span class="n">valid_name</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">)(</span><span class="n">files</span><span class="p">)</span>
    
    <span class="n">item_aug</span> <span class="o">=</span> <span class="p">[</span><span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">min_scale</span><span class="o">=</span><span class="mf">0.35</span><span class="p">),</span> <span class="n">FlipItem</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)]</span>
    <span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">PILImage</span><span class="o">.</span><span class="n">create</span><span class="p">,</span> <span class="n">ToTensor</span><span class="p">,</span> <span class="o">*</span><span class="n">item_aug</span><span class="p">],</span> 
            <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]]</span>
    
    <span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
    
    <span class="n">batch_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">IntToFloatTensor</span><span class="p">,</span> <span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="o">*</span><span class="n">imagenet_stats</span><span class="p">)]</span>
    <span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dls</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">split_func</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="k">return</span> <span class="n">L</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">create_learner</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;xresnet34&#39;</span><span class="p">,</span> <span class="n">encoder_path</span><span class="o">=</span><span class="s2">&quot;models/swav_iwang_sz128_epc100_encoder.pth&quot;</span><span class="p">):</span>
    
    <span class="n">dls</span> <span class="o">=</span> <span class="n">get_dls</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">pretrained_encoder</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">encoder_path</span><span class="p">)</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="n">create_encoder</span><span class="p">(</span><span class="n">arch</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">encoder</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">pretrained_encoder</span><span class="p">)</span>
    <span class="n">nf</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">224</span><span class="p">))</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">classifier</span> <span class="o">=</span> <span class="n">create_cls_module</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">classifier</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">())</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">,</span> <span class="n">splitter</span><span class="o">=</span><span class="n">split_func</span><span class="p">,</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span><span class="n">top_k_accuracy</span><span class="p">],</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">LabelSmoothingCrossEntropyFlat</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">learn</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">finetune</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">arch</span><span class="p">,</span> <span class="n">encoder_path</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">):</span>
    <span class="n">learn</span> <span class="o">=</span> <span class="n">create_learner</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">arch</span><span class="p">,</span> <span class="n">encoder_path</span><span class="p">)</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
<span class="c1">#     learn.freeze()</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_flat_cos</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="n">wd</span><span class="p">)</span>
    <span class="n">final_acc</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">final_acc</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5-epochs">5 epochs<a class="anchor-link" href="#5-epochs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span> <span class="n">acc</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finetune</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;resnet50d&#39;</span><span class="p">,</span> <span class="n">encoder_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;models/true-sweep-41_encoder.pth&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>top_k_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.891920</td>
      <td>2.030339</td>
      <td>0.488165</td>
      <td>0.848307</td>
      <td>01:25</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.895664</td>
      <td>2.121488</td>
      <td>0.499618</td>
      <td>0.815984</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.852885</td>
      <td>1.861526</td>
      <td>0.561721</td>
      <td>0.896411</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.819235</td>
      <td>1.766511</td>
      <td>0.596844</td>
      <td>0.926190</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.745480</td>
      <td>1.537153</td>
      <td>0.652329</td>
      <td>0.929753</td>
      <td>01:23</td>
    </tr>
  </tbody>
</table></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>top_k_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.880797</td>
      <td>2.130177</td>
      <td>0.483075</td>
      <td>0.844999</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.890207</td>
      <td>1.990296</td>
      <td>0.500382</td>
      <td>0.856452</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.845114</td>
      <td>2.021743</td>
      <td>0.513362</td>
      <td>0.867142</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.828395</td>
      <td>2.073368</td>
      <td>0.492492</td>
      <td>0.843981</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.745889</td>
      <td>1.514073</td>
      <td>0.674726</td>
      <td>0.930008</td>
      <td>01:23</td>
    </tr>
  </tbody>
</table></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>top_k_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.889642</td>
      <td>1.790089</td>
      <td>0.573683</td>
      <td>0.896411</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.878387</td>
      <td>1.874182</td>
      <td>0.552812</td>
      <td>0.901502</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.860759</td>
      <td>2.032588</td>
      <td>0.494019</td>
      <td>0.829982</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.821018</td>
      <td>1.880166</td>
      <td>0.542123</td>
      <td>0.876559</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.733482</td>
      <td>1.522297</td>
      <td>0.667345</td>
      <td>0.937898</td>
      <td>01:23</td>
    </tr>
  </tbody>
</table></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>top_k_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.888339</td>
      <td>2.043426</td>
      <td>0.500382</td>
      <td>0.848562</td>
      <td>01:25</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.888483</td>
      <td>2.042721</td>
      <td>0.477221</td>
      <td>0.846780</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.847030</td>
      <td>2.154033</td>
      <td>0.477475</td>
      <td>0.839654</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.818787</td>
      <td>1.850598</td>
      <td>0.545940</td>
      <td>0.890557</td>
      <td>01:24</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.751503</td>
      <td>1.554493</td>
      <td>0.656401</td>
      <td>0.931280</td>
      <td>01:24</td>
    </tr>
  </tbody>
</table></div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>top_k_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.880823</td>
      <td>2.091427</td>
      <td>0.483584</td>
      <td>0.887758</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.891838</td>
      <td>1.925979</td>
      <td>0.524561</td>
      <td>0.878341</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.855217</td>
      <td>1.836971</td>
      <td>0.542123</td>
      <td>0.890812</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.820396</td>
      <td>1.849614</td>
      <td>0.542886</td>
      <td>0.882413</td>
      <td>01:23</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.748284</td>
      <td>1.551022</td>
      <td>0.654620</td>
      <td>0.931026</td>
      <td>01:23</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.661084246635437</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="20-epochs">20 epochs<a class="anchor-link" href="#20-epochs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span> <span class="n">acc</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finetune</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;xresnet34&#39;</span><span class="p">,</span> <span class="n">encoder_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;models/confused-sweep-13_encoder.pth&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="80-epochs">80 epochs<a class="anchor-link" href="#80-epochs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span> <span class="n">acc</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finetune</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;xresnet34&#39;</span><span class="p">,</span><span class="n">encoder_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;models/confused-sweep-13_encoder.pth&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="200-epochs">200 epochs<a class="anchor-link" href="#200-epochs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">runs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span> <span class="n">acc</span> <span class="o">+=</span> <span class="p">[</span><span class="n">finetune</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;xresnet34&#39;</span><span class="p">,</span> <span class="n">encoder_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;models/confused-sweep-13_encoder.pth&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
    <div>
      <progress value='133' class='' max='200' style='width:300px; height:20px; vertical-align: middle;'></progress>
      66.50% [133/200 1:40:14<50:29]
    </div>
    
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>top_k_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.869703</td>
      <td>1.603625</td>
      <td>0.638330</td>
      <td>0.908628</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.738499</td>
      <td>1.532995</td>
      <td>0.658946</td>
      <td>0.923390</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.709089</td>
      <td>1.545185</td>
      <td>0.664291</td>
      <td>0.917282</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.705038</td>
      <td>1.519349</td>
      <td>0.665564</td>
      <td>0.927717</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.701668</td>
      <td>1.636940</td>
      <td>0.622550</td>
      <td>0.918809</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.695683</td>
      <td>1.543493</td>
      <td>0.663528</td>
      <td>0.916009</td>
      <td>00:50</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.686737</td>
      <td>1.539560</td>
      <td>0.671163</td>
      <td>0.923136</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.680906</td>
      <td>1.498526</td>
      <td>0.675999</td>
      <td>0.921354</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.677552</td>
      <td>1.508487</td>
      <td>0.667854</td>
      <td>0.922627</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.674518</td>
      <td>1.519361</td>
      <td>0.670654</td>
      <td>0.919063</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.665412</td>
      <td>1.550280</td>
      <td>0.655129</td>
      <td>0.921100</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.665843</td>
      <td>1.494319</td>
      <td>0.669891</td>
      <td>0.917791</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.660519</td>
      <td>1.488854</td>
      <td>0.681344</td>
      <td>0.921354</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.659262</td>
      <td>1.546521</td>
      <td>0.662510</td>
      <td>0.918045</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.655583</td>
      <td>1.676335</td>
      <td>0.629677</td>
      <td>0.891066</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.653679</td>
      <td>1.546218</td>
      <td>0.658692</td>
      <td>0.915246</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.654734</td>
      <td>1.507556</td>
      <td>0.670400</td>
      <td>0.916518</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.652892</td>
      <td>1.518740</td>
      <td>0.672436</td>
      <td>0.917536</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.649217</td>
      <td>1.471843</td>
      <td>0.682362</td>
      <td>0.928735</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.647636</td>
      <td>1.532747</td>
      <td>0.665309</td>
      <td>0.912955</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.647990</td>
      <td>1.544863</td>
      <td>0.659710</td>
      <td>0.917791</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.645690</td>
      <td>1.555919</td>
      <td>0.664546</td>
      <td>0.917536</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.644248</td>
      <td>1.616540</td>
      <td>0.645457</td>
      <td>0.902774</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.643940</td>
      <td>1.533293</td>
      <td>0.671927</td>
      <td>0.913719</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.643079</td>
      <td>1.493405</td>
      <td>0.677526</td>
      <td>0.923136</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.641105</td>
      <td>1.560501</td>
      <td>0.656656</td>
      <td>0.913973</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.641650</td>
      <td>1.511677</td>
      <td>0.673454</td>
      <td>0.916009</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.640307</td>
      <td>1.575970</td>
      <td>0.652583</td>
      <td>0.915246</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.639157</td>
      <td>1.613817</td>
      <td>0.646475</td>
      <td>0.910410</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.639705</td>
      <td>1.540645</td>
      <td>0.664800</td>
      <td>0.920336</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>30</td>
      <td>0.640183</td>
      <td>1.520499</td>
      <td>0.672690</td>
      <td>0.918300</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>31</td>
      <td>0.638371</td>
      <td>1.559659</td>
      <td>0.652329</td>
      <td>0.907356</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>32</td>
      <td>0.638882</td>
      <td>1.590857</td>
      <td>0.653092</td>
      <td>0.909901</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>33</td>
      <td>0.635947</td>
      <td>1.520144</td>
      <td>0.673454</td>
      <td>0.920590</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>34</td>
      <td>0.637217</td>
      <td>1.609845</td>
      <td>0.641130</td>
      <td>0.906592</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>35</td>
      <td>0.636331</td>
      <td>1.520351</td>
      <td>0.675235</td>
      <td>0.914482</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>36</td>
      <td>0.634860</td>
      <td>1.532848</td>
      <td>0.670145</td>
      <td>0.914228</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>37</td>
      <td>0.637789</td>
      <td>1.482974</td>
      <td>0.684144</td>
      <td>0.919318</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>38</td>
      <td>0.637334</td>
      <td>1.591692</td>
      <td>0.644693</td>
      <td>0.910410</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>39</td>
      <td>0.636380</td>
      <td>1.531559</td>
      <td>0.669891</td>
      <td>0.915246</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>40</td>
      <td>0.636859</td>
      <td>1.627369</td>
      <td>0.646475</td>
      <td>0.903029</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>41</td>
      <td>0.634279</td>
      <td>1.553971</td>
      <td>0.655638</td>
      <td>0.917027</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>42</td>
      <td>0.631529</td>
      <td>1.565562</td>
      <td>0.654365</td>
      <td>0.908628</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>43</td>
      <td>0.630301</td>
      <td>1.529892</td>
      <td>0.671418</td>
      <td>0.918809</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>44</td>
      <td>0.634323</td>
      <td>1.592670</td>
      <td>0.651311</td>
      <td>0.904301</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>45</td>
      <td>0.633182</td>
      <td>1.480278</td>
      <td>0.687707</td>
      <td>0.922372</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>46</td>
      <td>0.632433</td>
      <td>1.554290</td>
      <td>0.661746</td>
      <td>0.908883</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>47</td>
      <td>0.632967</td>
      <td>1.534170</td>
      <td>0.668618</td>
      <td>0.914228</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>48</td>
      <td>0.629657</td>
      <td>1.565951</td>
      <td>0.660982</td>
      <td>0.902774</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>49</td>
      <td>0.628943</td>
      <td>1.576432</td>
      <td>0.659455</td>
      <td>0.907356</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>50</td>
      <td>0.630356</td>
      <td>1.543911</td>
      <td>0.665055</td>
      <td>0.915246</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>51</td>
      <td>0.630036</td>
      <td>1.553484</td>
      <td>0.669381</td>
      <td>0.904810</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>52</td>
      <td>0.629229</td>
      <td>1.583017</td>
      <td>0.653601</td>
      <td>0.909392</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>53</td>
      <td>0.629157</td>
      <td>1.551492</td>
      <td>0.666073</td>
      <td>0.909646</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>54</td>
      <td>0.629943</td>
      <td>1.549929</td>
      <td>0.670654</td>
      <td>0.909901</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>55</td>
      <td>0.629232</td>
      <td>1.532147</td>
      <td>0.669127</td>
      <td>0.912700</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>56</td>
      <td>0.630214</td>
      <td>1.550726</td>
      <td>0.662255</td>
      <td>0.921863</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>57</td>
      <td>0.628146</td>
      <td>1.583061</td>
      <td>0.664800</td>
      <td>0.910155</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>58</td>
      <td>0.628307</td>
      <td>1.603759</td>
      <td>0.646729</td>
      <td>0.899975</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>59</td>
      <td>0.626960</td>
      <td>1.559176</td>
      <td>0.662764</td>
      <td>0.913464</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>60</td>
      <td>0.629398</td>
      <td>1.533982</td>
      <td>0.667600</td>
      <td>0.911173</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>61</td>
      <td>0.627043</td>
      <td>1.605522</td>
      <td>0.648257</td>
      <td>0.908628</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>62</td>
      <td>0.629501</td>
      <td>1.600642</td>
      <td>0.653092</td>
      <td>0.909646</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>63</td>
      <td>0.628051</td>
      <td>1.556016</td>
      <td>0.668618</td>
      <td>0.917282</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>64</td>
      <td>0.628616</td>
      <td>1.535497</td>
      <td>0.667091</td>
      <td>0.911173</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>65</td>
      <td>0.628973</td>
      <td>1.554626</td>
      <td>0.662001</td>
      <td>0.911428</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>66</td>
      <td>0.628108</td>
      <td>1.609547</td>
      <td>0.642657</td>
      <td>0.894630</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>67</td>
      <td>0.627201</td>
      <td>1.549583</td>
      <td>0.662001</td>
      <td>0.912446</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>68</td>
      <td>0.630659</td>
      <td>1.537625</td>
      <td>0.667091</td>
      <td>0.908374</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>69</td>
      <td>0.627197</td>
      <td>1.593526</td>
      <td>0.650293</td>
      <td>0.902265</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>70</td>
      <td>0.625676</td>
      <td>1.612805</td>
      <td>0.644184</td>
      <td>0.906847</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>71</td>
      <td>0.626757</td>
      <td>1.589640</td>
      <td>0.650038</td>
      <td>0.913464</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>72</td>
      <td>0.626163</td>
      <td>1.597183</td>
      <td>0.653092</td>
      <td>0.906847</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>73</td>
      <td>0.626740</td>
      <td>1.579899</td>
      <td>0.657419</td>
      <td>0.911173</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>74</td>
      <td>0.624481</td>
      <td>1.613326</td>
      <td>0.649529</td>
      <td>0.902520</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>75</td>
      <td>0.622779</td>
      <td>1.542646</td>
      <td>0.670654</td>
      <td>0.909901</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>76</td>
      <td>0.625912</td>
      <td>1.700185</td>
      <td>0.630186</td>
      <td>0.882158</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>77</td>
      <td>0.624742</td>
      <td>1.543221</td>
      <td>0.670909</td>
      <td>0.915246</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>78</td>
      <td>0.625231</td>
      <td>1.602534</td>
      <td>0.653092</td>
      <td>0.899975</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>79</td>
      <td>0.625685</td>
      <td>1.673348</td>
      <td>0.636040</td>
      <td>0.895648</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>80</td>
      <td>0.625234</td>
      <td>1.629006</td>
      <td>0.644948</td>
      <td>0.903283</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>81</td>
      <td>0.623205</td>
      <td>1.648422</td>
      <td>0.643421</td>
      <td>0.886994</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>82</td>
      <td>0.625121</td>
      <td>1.685609</td>
      <td>0.624332</td>
      <td>0.901502</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>83</td>
      <td>0.624947</td>
      <td>1.617991</td>
      <td>0.648257</td>
      <td>0.903029</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>84</td>
      <td>0.624974</td>
      <td>1.550486</td>
      <td>0.668363</td>
      <td>0.917536</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>85</td>
      <td>0.624651</td>
      <td>1.582956</td>
      <td>0.668109</td>
      <td>0.895902</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>86</td>
      <td>0.625576</td>
      <td>1.700037</td>
      <td>0.630949</td>
      <td>0.883431</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>87</td>
      <td>0.624592</td>
      <td>1.609895</td>
      <td>0.645966</td>
      <td>0.901502</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>88</td>
      <td>0.625317</td>
      <td>1.632035</td>
      <td>0.658946</td>
      <td>0.886231</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>89</td>
      <td>0.621874</td>
      <td>1.582937</td>
      <td>0.648257</td>
      <td>0.903029</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>90</td>
      <td>0.626025</td>
      <td>1.598742</td>
      <td>0.659455</td>
      <td>0.892848</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>91</td>
      <td>0.624505</td>
      <td>1.629864</td>
      <td>0.651311</td>
      <td>0.898193</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>92</td>
      <td>0.624303</td>
      <td>1.718987</td>
      <td>0.621023</td>
      <td>0.890557</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>93</td>
      <td>0.624256</td>
      <td>1.644525</td>
      <td>0.641894</td>
      <td>0.907356</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>94</td>
      <td>0.621443</td>
      <td>1.555878</td>
      <td>0.661237</td>
      <td>0.912446</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>95</td>
      <td>0.620402</td>
      <td>1.616238</td>
      <td>0.645711</td>
      <td>0.893866</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>96</td>
      <td>0.624698</td>
      <td>1.622719</td>
      <td>0.645711</td>
      <td>0.900738</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>97</td>
      <td>0.624898</td>
      <td>1.656592</td>
      <td>0.638839</td>
      <td>0.905574</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>98</td>
      <td>0.623742</td>
      <td>1.645989</td>
      <td>0.641130</td>
      <td>0.902774</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>99</td>
      <td>0.621856</td>
      <td>1.625195</td>
      <td>0.646984</td>
      <td>0.892594</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>100</td>
      <td>0.624188</td>
      <td>1.676001</td>
      <td>0.634767</td>
      <td>0.894630</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>101</td>
      <td>0.622995</td>
      <td>1.578023</td>
      <td>0.657165</td>
      <td>0.907865</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>102</td>
      <td>0.622677</td>
      <td>1.599621</td>
      <td>0.652329</td>
      <td>0.903029</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>103</td>
      <td>0.619904</td>
      <td>1.594792</td>
      <td>0.655383</td>
      <td>0.895393</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>104</td>
      <td>0.620121</td>
      <td>1.643322</td>
      <td>0.649275</td>
      <td>0.890812</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>105</td>
      <td>0.620024</td>
      <td>1.587936</td>
      <td>0.653347</td>
      <td>0.905828</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>106</td>
      <td>0.621057</td>
      <td>1.604326</td>
      <td>0.660219</td>
      <td>0.895393</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>107</td>
      <td>0.621163</td>
      <td>1.584998</td>
      <td>0.663273</td>
      <td>0.907865</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>108</td>
      <td>0.620983</td>
      <td>1.603610</td>
      <td>0.656147</td>
      <td>0.904556</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>109</td>
      <td>0.620239</td>
      <td>1.637596</td>
      <td>0.647238</td>
      <td>0.894375</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>110</td>
      <td>0.620139</td>
      <td>1.673262</td>
      <td>0.637567</td>
      <td>0.890812</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>111</td>
      <td>0.619876</td>
      <td>1.731578</td>
      <td>0.616951</td>
      <td>0.870450</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>112</td>
      <td>0.619817</td>
      <td>1.775249</td>
      <td>0.609824</td>
      <td>0.882413</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>113</td>
      <td>0.619827</td>
      <td>1.544595</td>
      <td>0.671672</td>
      <td>0.916009</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>114</td>
      <td>0.619299</td>
      <td>1.645119</td>
      <td>0.645711</td>
      <td>0.905574</td>
      <td>00:49</td>
    </tr>
    <tr>
      <td>115</td>
      <td>0.620907</td>
      <td>1.712692</td>
      <td>0.625095</td>
      <td>0.883940</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>116</td>
      <td>0.619116</td>
      <td>1.605237</td>
      <td>0.657419</td>
      <td>0.893866</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>117</td>
      <td>0.620825</td>
      <td>1.602566</td>
      <td>0.656656</td>
      <td>0.902774</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>118</td>
      <td>0.623467</td>
      <td>1.669477</td>
      <td>0.628913</td>
      <td>0.898956</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>119</td>
      <td>0.621086</td>
      <td>1.641958</td>
      <td>0.650547</td>
      <td>0.894375</td>
      <td>00:49</td>
    </tr>
    <tr>
      <td>120</td>
      <td>0.620659</td>
      <td>1.683734</td>
      <td>0.639094</td>
      <td>0.891321</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>121</td>
      <td>0.620320</td>
      <td>1.571884</td>
      <td>0.671418</td>
      <td>0.902774</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>122</td>
      <td>0.619457</td>
      <td>1.696718</td>
      <td>0.641130</td>
      <td>0.900484</td>
      <td>00:49</td>
    </tr>
    <tr>
      <td>123</td>
      <td>0.622396</td>
      <td>1.612049</td>
      <td>0.648766</td>
      <td>0.909646</td>
      <td>00:45</td>
    </tr>
    <tr>
      <td>124</td>
      <td>0.625176</td>
      <td>1.751117</td>
      <td>0.617969</td>
      <td>0.881649</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>125</td>
      <td>0.622359</td>
      <td>1.547589</td>
      <td>0.669381</td>
      <td>0.913209</td>
      <td>00:48</td>
    </tr>
    <tr>
      <td>126</td>
      <td>0.631657</td>
      <td>1.654508</td>
      <td>0.644184</td>
      <td>0.902265</td>
      <td>00:48</td>
    </tr>
    <tr>
      <td>127</td>
      <td>0.627171</td>
      <td>1.564172</td>
      <td>0.661237</td>
      <td>0.911173</td>
      <td>00:46</td>
    </tr>
    <tr>
      <td>128</td>
      <td>0.624255</td>
      <td>1.537886</td>
      <td>0.672436</td>
      <td>0.914991</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>129</td>
      <td>0.619449</td>
      <td>1.555512</td>
      <td>0.664037</td>
      <td>0.912700</td>
      <td>00:47</td>
    </tr>
    <tr>
      <td>130</td>
      <td>0.621423</td>
      <td>1.786124</td>
      <td>0.612879</td>
      <td>0.875286</td>
      <td>00:43</td>
    </tr>
    <tr>
      <td>131</td>
      <td>0.624269</td>
      <td>1.628261</td>
      <td>0.644184</td>
      <td>0.892594</td>
      <td>00:44</td>
    </tr>
    <tr>
      <td>132</td>
      <td>0.623737</td>
      <td>1.580078</td>
      <td>0.656656</td>
      <td>0.904556</td>
      <td>00:44</td>
    </tr>
  </tbody>
</table><p>

    <div>
      <progress value='44' class='' max='91' style='width:300px; height:20px; vertical-align: middle;'></progress>
      48.35% [44/91 00:18<00:19 0.6242]
    </div>
    </div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

