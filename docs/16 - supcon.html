---

title: SupCon


keywords: fastai
sidebar: home_sidebar

summary: "**SupCon**: <a href='https://arxiv.org/pdf/2004.11362.pdf'>Supervised Contrastive Learning</a>"
description: "**SupCon**: <a href='https://arxiv.org/pdf/2004.11362.pdf'>Supervised Contrastive Learning</a>"
nb_path: "nbs/16 - supcon.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/16 - supcon.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Algorithm">Algorithm<a class="anchor-link" href="#Algorithm"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="SupCon">SupCon<a class="anchor-link" href="#SupCon"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/self_supervised/images/supcon.png" alt="SupCon Framework"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SupCon introduces a generalized form for contrastive losses, and shows that self-supervised loss from SimCLR, N-Pair loss and triplet margin loss are special cases. In this repo, we leverage this general form and formalize a loss that can transition from self-supervised contrastive loss to supervised contrastive loss:</p>
$$
\begin{equation} 
\begin{split}
\mathcal{L} &amp; = \hspace{30mm} \mathcal{L}^{unsup} \hspace{16mm}+ \hspace{30mm} \lambda\mathcal{L}^{sup} \\
            \\
            &amp; = - \sum_{i \in I} \log \frac{\exp \left(\boldsymbol{z}_{i} \cdot \boldsymbol{z}_{j(i)} / \tau\right)}{\sum_{a \in A(i)} \exp \left(\boldsymbol{z}_{i} \cdot \boldsymbol{z}_{a} / \tau\right)} + \lambda \sum_{i \in I} \frac{-1}{|P(i)|} \sum_{p \in P(i)} \log \frac{\exp \left(\boldsymbol{z}_{i} \cdot \boldsymbol{z}_{p} / \tau\right)}{\sum_{a \in A(i)} \exp \left(\boldsymbol{z}_{i} \cdot \boldsymbol{z}_{a} / \tau\right)}
\end{split}
\end{equation}
$$<p>We use supervised signal as regularization which has an associated weight $\lambda$, this allows to pretrain with a dataset mixed with labelled and unlabelled data. This regularization can help to learn more generic features which in turn can help with the downstream task. In <a href="/self_supervised/16 - supcon.html#SupCon"><code>SupCon</code></a> callback you can choose to use all samples (<code>UnsupMethod.All</code>) for unsupervised loss or only use the ones doesn't have a label (<code>UnsupMethod.All</code>). Supervised loss will use the samples with labels.</p>
<p>Therefore, positive samples come form two disjoint categories:</p>

<pre><code>(1) Other view of the anchor sample after augmentation (self-supervised case)
(2) All views of the samples that have the same class id with anchor, including the other view of the same sample (supervised case)



</code></pre>
<p><em>Note that self-supervised and unsupervised are used interchangably in this context</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SimCLR model consists of an <code>encoder</code> and a <code>projector (MLP)</code> layer. The definition of this module is fairly simple as below.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SupConModel" class="doc_header"><code>class</code> <code>SupConModel</code><a href="https://github.com/keremturgutlu/self_supervised/tree/main/self_supervised/vision/supcon.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SupConModel</code>(<strong><code>encoder</code></strong>, <strong><code>projector</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Compute predictions of concatenated xi and xj</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instead of directly using <a href="/self_supervised/16 - supcon.html#SupConModel"><code>SupConModel</code></a> by passing both an <code>encoder</code> and a <code>projector</code>, <a href="/self_supervised/10 - simclr.html#create_simclr_model"><code>create_simclr_model</code></a> function can be used by minimally passing a predefined <code>encoder</code> and the expected input channels.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_supcon_model" class="doc_header"><code>create_supcon_model</code><a href="https://github.com/keremturgutlu/self_supervised/tree/main/self_supervised/vision/supcon.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_supcon_model</code>(<strong><code>encoder</code></strong>, <strong><code>hidden_size</code></strong>=<em><code>256</code></em>, <strong><code>projection_size</code></strong>=<em><code>128</code></em>, <strong><code>bn</code></strong>=<em><code>False</code></em>, <strong><code>nlayers</code></strong>=<em><code>2</code></em>)</p>
</blockquote>
<p>Create SupCon model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use <code>self_supervised.layers</code> module to create an encoder. It supports all <strong>timm</strong> and <strong>fastai</strong> models available out of the box.</p>
<p>We define number of input channels with <code>n_in</code>, projector/mlp's hidden size with <code>hidden_size</code>,  projector/mlp's final projection size with <code>projection_size</code> and projector/mlp's number of layers with <code>nlayers</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">create_encoder</span><span class="p">(</span><span class="s2">&quot;tf_efficientnet_b0_ns&quot;</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pool_type</span><span class="o">=</span><span class="n">PoolingType</span><span class="o">.</span><span class="n">CatAvgMax</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">create_supcon_model</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">projection_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">nlayers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">224</span><span class="p">)));</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([2, 128])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SupCon-Callback">SupCon Callback<a class="anchor-link" href="#SupCon-Callback"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following parameters can be passed;</p>
<ul>
<li><strong>aug_pipelines</strong> list of augmentation pipelines List[Pipeline] created using functions from <code>self_supervised.augmentations</code> module. Each <code>Pipeline</code> should be set to <code>split_idx=0</code>. You can simply use <a href="/self_supervised/16 - supcon.html#get_supcon_aug_pipelines"><code>get_supcon_aug_pipelines</code></a> utility to get aug_pipelines.</li>
<li><strong>temp</strong> temperature scaling for cross entropy loss (defaults to paper's best value)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SupCon algorithm uses 2 views of a given image, and <a href="/self_supervised/16 - supcon.html#SupCon"><code>SupCon</code></a> callback expects a list of 2 augmentation pipelines in <code>aug_pipelines</code>.</p>
<p>You can simply use helper function <code>get_supcon_aug_pipelines()</code> which will allow augmentation related arguments such as size, rotate, jitter...and will return a list of 2 pipelines, which then can be passed to the callback. This function uses <a href="/self_supervised/01 - augmentations.html#get_multi_aug_pipelines"><code>get_multi_aug_pipelines</code></a> which then <a href="/self_supervised/01 - augmentations.html#get_batch_augs"><code>get_batch_augs</code></a>. For more information you may refer to <code>self_supervised.augmentations</code> module.</p>
<p>Also, you may choose to pass your own list of aug_pipelines which needs to be List[Pipeline, Pipeline] where Pipeline(..., split_idx=0). Here, <code>split_idx=0</code> forces augmentations to be applied in training mode.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_supcon_aug_pipelines" class="doc_header"><code>get_supcon_aug_pipelines</code><a href="https://github.com/keremturgutlu/self_supervised/tree/main/self_supervised/vision/supcon.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_supcon_aug_pipelines</code>(<strong><code>size</code></strong>, <strong><code>rotate</code></strong>=<em><code>True</code></em>, <strong><code>jitter</code></strong>=<em><code>True</code></em>, <strong><code>bw</code></strong>=<em><code>True</code></em>, <strong><code>blur</code></strong>=<em><code>True</code></em>, <strong><code>resize_scale</code></strong>=<em><code>(0.2, 1.0)</code></em>, <strong><code>resize_ratio</code></strong>=<em><code>(0.75, 1.3333333333333333)</code></em>, <strong><code>rotate_deg</code></strong>=<em><code>30</code></em>, <strong><code>jitter_s</code></strong>=<em><code>0.6</code></em>, <strong><code>blur_s</code></strong>=<em><code>(4, 32)</code></em>, <strong><code>same_on_batch</code></strong>=<em><code>False</code></em>, <strong><code>flip_p</code></strong>=<em><code>0.5</code></em>, <strong><code>rotate_p</code></strong>=<em><code>0.3</code></em>, <strong><code>jitter_p</code></strong>=<em><code>0.3</code></em>, <strong><code>bw_p</code></strong>=<em><code>0.3</code></em>, <strong><code>blur_p</code></strong>=<em><code>0.3</code></em>, <strong><code>stats</code></strong>=<em><code>([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])</code></em>, <strong><code>cuda</code></strong>=<em><code>True</code></em>, <strong><code>xtra_tfms</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aug_pipelines</span> <span class="o">=</span> <span class="n">get_supcon_aug_pipelines</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">aug_pipelines</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Pipeline: RandomResizedCrop -&gt; RandomHorizontalFlip,
 Pipeline: RandomResizedCrop -&gt; RandomHorizontalFlip]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SupCon" class="doc_header"><code>class</code> <code>SupCon</code><a href="https://github.com/keremturgutlu/self_supervised/tree/main/self_supervised/vision/supcon.py#L37" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SupCon</code>(<strong><code>aug_pipelines</code></strong>, <strong><code>unsup_class_id</code></strong>, <strong><code>unsup_method</code></strong>=<em><code>'all'</code></em>, <strong><code>reg_lambda</code></strong>=<em><code>1.0</code></em>, <strong><code>temp</code></strong>=<em><code>0.07</code></em>, <strong><code>print_augs</code></strong>=<em><code>False</code></em>) :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">supcon</span> <span class="o">=</span> <span class="n">SupCon</span><span class="p">([</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">),</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">)],</span> <span class="n">unsup_class_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unsup_method</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="n">yb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">yb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">@</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">supcon</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="n">nll</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])]))</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss1</span><span class="p">,</span><span class="n">loss2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">@</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">supcon</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ohe</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]))</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="p">(</span><span class="n">tensor</span><span class="p">([(</span><span class="n">row</span><span class="p">[</span><span class="n">idxs</span><span class="o">.</span><span class="n">bool</span><span class="p">()]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">idxs</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">idxs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nll</span><span class="p">,</span> <span class="n">ohe</span><span class="p">)]))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss1</span><span class="p">,</span> <span class="n">loss2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">supcon</span> <span class="o">=</span> <span class="n">SupCon</span><span class="p">([</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">),</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">)],</span> <span class="n">unsup_class_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unsup_method</span><span class="o">=</span><span class="s2">&quot;only&quot;</span><span class="p">)</span>
<span class="n">yb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">yb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">@</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">supcon</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ohe</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]))</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="p">(</span><span class="n">tensor</span><span class="p">([(</span><span class="n">row</span><span class="p">[</span><span class="n">idxs</span><span class="o">.</span><span class="n">bool</span><span class="p">()]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">idxs</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">idxs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nll</span><span class="p">,</span> <span class="n">ohe</span><span class="p">)]))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss1</span><span class="p">,</span><span class="n">loss2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">yb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">supcon</span> <span class="o">=</span> <span class="n">SupCon</span><span class="p">([</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">),</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">)],</span> <span class="n">unsup_class_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unsup_method</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">supcon</span> <span class="o">=</span> <span class="n">SupCon</span><span class="p">([</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">),</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">)],</span> <span class="n">unsup_class_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unsup_method</span><span class="o">=</span><span class="s2">&quot;only&quot;</span><span class="p">)</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">@</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">supcon</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loss3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="n">nll</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])]))</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss1</span><span class="p">,</span> <span class="n">loss2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss2</span><span class="p">,</span> <span class="n">loss3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">yb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
<span class="n">supcon</span> <span class="o">=</span> <span class="n">SupCon</span><span class="p">([</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">),</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">)],</span> <span class="n">unsup_class_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unsup_method</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">@</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">supcon</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="n">nll</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])]))</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss1</span><span class="p">,</span> <span class="n">loss2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">supcon</span> <span class="o">=</span> <span class="n">SupCon</span><span class="p">([</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">),</span><span class="n">Pipeline</span><span class="p">([],</span><span class="mi">0</span><span class="p">)],</span> <span class="n">unsup_class_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unsup_method</span><span class="o">=</span><span class="s2">&quot;only&quot;</span><span class="p">)</span>
<span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1"># log(1) -&gt; 0, there is no negative sample</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss1</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">targ</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">yb</span><span class="p">,</span><span class="n">yb</span><span class="p">])</span>
<span class="n">unsup_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">targ</span> <span class="o">==</span> <span class="n">supcon</span><span class="o">.</span><span class="n">unsup_class_id</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="o">~</span><span class="n">unsup_mask</span><span class="p">]</span>
<span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span> <span class="o">@</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">supcon</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ohe</span> <span class="o">=</span> <span class="n">supcon</span><span class="o">.</span><span class="n">_remove_diag</span><span class="p">(</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]))</span>

<span class="n">loss2</span> <span class="o">=</span> <span class="p">(</span><span class="n">tensor</span><span class="p">([(</span><span class="n">row</span><span class="p">[</span><span class="n">idxs</span><span class="o">.</span><span class="n">bool</span><span class="p">()]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">idxs</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">idxs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nll</span><span class="p">,</span> <span class="n">ohe</span><span class="p">)]))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">loss1</span><span class="p">,</span> <span class="n">loss2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SupConMOCO-Callback-%5BExperimental%5D">SupConMOCO Callback [Experimental]<a class="anchor-link" href="#SupConMOCO-Callback-%5BExperimental%5D"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following parameters can be passed;</p>
<ul>
<li><strong>aug_pipelines</strong> list of augmentation pipelines List[Pipeline] created using functions from <code>self_supervised.augmentations</code> module. Each <code>Pipeline</code> should be set to <code>split_idx=0</code>. You can simply use <a href="/self_supervised/16 - supcon.html#get_supcon_aug_pipelines"><code>get_supcon_aug_pipelines</code></a> utility to get aug_pipelines.</li>
<li><strong>temp</strong> temperature scaling for cross entropy loss (defaults to paper's best value)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>SupCon algorithm uses 2 views of a given image, and <a href="/self_supervised/16 - supcon.html#SupCon"><code>SupCon</code></a> callback expects a list of 2 augmentation pipelines in <code>aug_pipelines</code>.</p>
<p>You can simply use helper function <code>get_supcon_aug_pipelines()</code> which will allow augmentation related arguments such as size, rotate, jitter...and will return a list of 2 pipelines, which then can be passed to the callback. This function uses <a href="/self_supervised/01 - augmentations.html#get_multi_aug_pipelines"><code>get_multi_aug_pipelines</code></a> which then <a href="/self_supervised/01 - augmentations.html#get_batch_augs"><code>get_batch_augs</code></a>. For more information you may refer to <code>self_supervised.augmentations</code> module.</p>
<p>Also, you may choose to pass your own list of aug_pipelines which needs to be List[Pipeline, Pipeline] where Pipeline(..., split_idx=0). Here, <code>split_idx=0</code> forces augmentations to be applied in training mode.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SupConMOCO" class="doc_header"><code>class</code> <code>SupConMOCO</code><a href="https://github.com/keremturgutlu/self_supervised/tree/main/self_supervised/vision/supcon.py#L120" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SupConMOCO</code>(<strong><code>aug_pipelines</code></strong>, <strong><code>unsup_class_id</code></strong>, <strong><code>unsup_method</code></strong>=<em><code>'all'</code></em>, <strong><code>K</code></strong>=<em><code>4096</code></em>, <strong><code>m</code></strong>=<em><code>0.999</code></em>, <strong><code>reg_lambda</code></strong>=<em><code>1.0</code></em>, <strong><code>temp</code></strong>=<em><code>0.07</code></em>, <strong><code>print_augs</code></strong>=<em><code>False</code></em>) :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.test_utils</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ContrastiveModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span>   <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projector</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projector</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">supcon</span> <span class="o">=</span> <span class="n">SupConMOCO</span><span class="p">([</span><span class="n">Pipeline</span><span class="p">([</span><span class="n">noop</span><span class="p">],</span><span class="mi">0</span><span class="p">),</span><span class="n">Pipeline</span><span class="p">([</span><span class="n">noop</span><span class="p">],</span><span class="mi">0</span><span class="p">)],</span> <span class="n">unsup_class_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unsup_method</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">reg_lambda</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">0.07</span><span class="p">)</span>
<span class="n">yb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">yb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">128</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span> <span class="o">=</span> <span class="n">synth_learner</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="n">supcon</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">synth_dbunch</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">model</span><span class="o">=</span><span class="n">ContrastiveModel</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">aug1</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">aug2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Pipeline: , Pipeline: )</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;__stored_args__&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;unsup_class_id&#39;: 0,
 &#39;unsup_method&#39;: &#39;all&#39;,
 &#39;K&#39;: 8,
 &#39;m&#39;: 0.999,
 &#39;reg_lambda&#39;: 1.0,
 &#39;temp&#39;: 0.07}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="p">(</span><span class="s1">&#39;before_fit&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">label_queue</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">requires_grad</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="o">.</span><span class="n">parameters</span><span class="p">()))</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="o">.</span><span class="n">projector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">learner</span><span class="o">.</span><span class="n">_split</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">learner</span><span class="p">(</span><span class="s1">&#39;before_batch&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">yb</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">key_embs</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="mf">0.1</span> <span class="c1"># pseudo param update 1.0 -&gt; 1.1</span>
<span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">projector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="mf">0.1</span> <span class="c1"># pseudo param update 1.0 -&gt; 1.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="p">(</span><span class="s1">&#39;after_step&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">key_embs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newval</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">supcon</span><span class="o">.</span><span class="n">m</span> <span class="o">+</span> <span class="mf">1.1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">supcon</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">newval</span><span class="p">)</span> <span class="ow">and</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="o">.</span><span class="n">projector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">==</span><span class="n">newval</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">learner</span><span class="o">.</span><span class="n">_split</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">learner</span><span class="p">(</span><span class="s1">&#39;before_batch&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">yb</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">key_embs</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="p">(</span><span class="s1">&#39;after_step&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">key_embs</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">label_queue</span><span class="p">,</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newval</span> <span class="o">=</span> <span class="n">newval</span><span class="o">*</span><span class="n">supcon</span><span class="o">.</span><span class="n">m</span> <span class="o">+</span> <span class="mf">1.1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">supcon</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">newval</span><span class="p">)</span> <span class="ow">and</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">encoder_k</span><span class="o">.</span><span class="n">projector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">==</span><span class="n">newval</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="n">loss1</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="o">*</span><span class="n">learner</span><span class="o">.</span><span class="n">yb</span><span class="p">)</span>
<span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">yb</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">key_embs</span><span class="p">,</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">temp</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="n">loss2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_method</span> <span class="o">=</span> <span class="n">UnsupMethod</span><span class="o">.</span><span class="n">Only</span>
<span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_class_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">loss1</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="o">*</span><span class="n">learner</span><span class="o">.</span><span class="n">yb</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">key_embs</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="mi">1</span><span class="p">],</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">label_queue</span><span class="o">==</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">temp</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="n">loss2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_class_id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="n">loss1</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="o">*</span><span class="n">learner</span><span class="o">.</span><span class="n">yb</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">pred</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">key_embs</span><span class="p">,</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">temp</span>
<span class="n">ohe_labels</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">ohe_labels</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">ohe_labels</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="n">loss2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_class_id</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="n">loss1</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="o">*</span><span class="n">learner</span><span class="o">.</span><span class="n">yb</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">labels</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">]</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">key_embs</span><span class="p">[</span><span class="n">labels</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">],</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">label_queue</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">temp</span>
<span class="n">ohe_labels</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">ohe_labels</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">ohe_labels</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="n">loss2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">yb</span>
<span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_class_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">learner</span><span class="o">.</span><span class="n">xb</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">]])]),)</span>
<span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">])])</span>
<span class="n">learner</span><span class="o">.</span><span class="n">yb</span> <span class="o">=</span> <span class="p">(</span><span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
<span class="n">loss1</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="o">*</span><span class="n">learner</span><span class="o">.</span><span class="n">yb</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">labels</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">]</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">key_embs</span><span class="p">[</span><span class="n">labels</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">],</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">label_queue</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">temp</span>
<span class="n">ohe_labels</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">ohe_labels</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">ohe_labels</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="n">loss2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">yb</span>
<span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">unsup_class_id</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">learner</span><span class="o">.</span><span class="n">xb</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]),)</span>
<span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span> <span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">1</span><span class="p">],</span> <span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">:]]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span>  <span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">]),</span> <span class="n">learner</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:]])</span>

<span class="n">learner</span><span class="o">.</span><span class="n">yb</span> <span class="o">=</span> <span class="p">(</span><span class="n">key_embs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>

<span class="n">loss1</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">sup_lf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="o">*</span><span class="n">learner</span><span class="o">.</span><span class="n">yb</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">labels</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">]</span> <span class="o">@</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">key_embs</span><span class="p">[</span><span class="n">labels</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">],</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">emb_queue</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">label_queue</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">learner</span><span class="o">.</span><span class="n">sup_con_moco</span><span class="o">.</span><span class="n">temp</span>
<span class="n">ohe_labels</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">loss2</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">ohe_labels</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">ohe_labels</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">loss1</span> <span class="o">==</span> <span class="n">loss2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-Usage">Example Usage<a class="anchor-link" href="#Example-Usage"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">IMAGEWANG_160</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="p">[[</span><span class="n">PILImage</span><span class="o">.</span><span class="n">create</span><span class="p">,</span> <span class="n">ToTensor</span><span class="p">,</span> <span class="n">RandomResizedCrop</span><span class="p">(</span><span class="mi">112</span><span class="p">,</span> <span class="n">min_scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">)],</span>
                       <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]],</span> <span class="n">splits</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">()(</span><span class="n">items</span><span class="p">))</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">tds</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">after_item</span><span class="o">=</span><span class="p">[</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">IntToFloatTensor</span><span class="p">()],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unsup_class_id</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unsup&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fastai_encoder</span> <span class="o">=</span> <span class="n">create_encoder</span><span class="p">(</span><span class="s1">&#39;xresnet18&#39;</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">create_supcon_model</span><span class="p">(</span><span class="n">fastai_encoder</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">projection_size</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">aug_pipelines</span> <span class="o">=</span> <span class="n">get_supcon_aug_pipelines</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SupCon</span><span class="p">(</span><span class="n">aug_pipelines</span><span class="p">,</span> 
                                        <span class="n">unsup_class_id</span><span class="p">,</span>
                                        <span class="n">unsup_method</span><span class="o">=</span><span class="n">UnsupMethod</span><span class="o">.</span><span class="n">All</span><span class="p">,</span> <span class="n">reg_lambda</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span>
                                        <span class="n">print_augs</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="n">ShortEpochCallback</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline: RandomResizedCrop -&gt; RandomHorizontalFlip
Pipeline: RandomResizedCrop -&gt; RandomHorizontalFlip
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Also, with <code>show_one()</code> method you can inspect data augmentations as a sanity check. You can use existing augmentation functions from <code>augmentations</code> module.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">_split</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">learn</span><span class="p">(</span><span class="s1">&#39;before_batch&#39;</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">sup_con</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>00:02</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">losses</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[TensorCategory(1.7556)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fastai_encoder</span> <span class="o">=</span> <span class="n">create_encoder</span><span class="p">(</span><span class="s1">&#39;xresnet18&#39;</span><span class="p">,</span> <span class="n">n_in</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">create_supcon_model</span><span class="p">(</span><span class="n">fastai_encoder</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">projection_size</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="n">aug_pipelines</span> <span class="o">=</span> <span class="n">get_supcon_aug_pipelines</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">SupConMOCO</span><span class="p">(</span><span class="n">aug_pipelines</span><span class="p">,</span> 
                                            <span class="n">unsup_class_id</span><span class="p">,</span>
                                            <span class="n">unsup_method</span><span class="o">=</span><span class="n">UnsupMethod</span><span class="o">.</span><span class="n">All</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">reg_lambda</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span>
                                            <span class="n">print_augs</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="n">ShortEpochCallback</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Pipeline: RandomResizedCrop -&gt; RandomHorizontalFlip
Pipeline: RandomResizedCrop -&gt; RandomHorizontalFlip
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>00:06</td>
    </tr>
  </tbody>
</table></div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

